import{s as b}from"./e1619f58.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        */import{a as n,o as D,t as U,r as B,u as I,v as $,w as K,x as F,y as H,z as M,p as G}from"./431e6e02.js";import{H as W,r as A,d as j,l as y,m as q,V as e,P as s,T as c,U as J,O as k,S as L,p as S}from"./95bbca75.js";const p={addListener(r){return b({url:"/listener/add",method:"POST",data:r})},getListenerList(){return b({url:"/listener/list",method:"GET"})},openListener(r){return b({url:"/listener/open",method:"POST",data:r})},closeListener(r){return b({url:"/listener/close",method:"POST",data:r})},deleteListener(r){return b({url:"/listener/delete",method:"POST",data:r})}},Q=S("br",null,null,-1),R=S("br",null,null,-1),re=W({__name:"listener",setup(r){const V=A([]),l=A({protocol:"websocket",listenAddress:"",connectAddress:""}),u=A({endpoint:"oss-cn-hangzhou.aliyuncs.com",bucketName:"alisso"}),m=A(!1),d=async()=>{const o=await p.getListenerList();o.status===200&&(V.value=o.data.data)},g=async()=>{if(l.value.protocol==="oss"){const o=await p.addListener({type:l.value.protocol,listenAddress:u.value.endpoint+":"+l.value.listenAddress+":"+l.value.connectAddress+":"+u.value.bucketName,connectAddress:u.value.endpoint+":"+l.value.listenAddress+":"+l.value.connectAddress+":"+u.value.bucketName});o.status===200&&(o.data.status===200?(n.success("添加成功"),await d()):n.error(o.data.data)),m.value=!1}else{const o=await p.addListener({type:l.value.protocol,listenAddress:l.value.listenAddress,connectAddress:l.value.connectAddress});o.status===200&&(o.data.status===200?(n.success("添加成功"),await d()):n.error(o.data.data)),m.value=!1}},E=async o=>{const t=await p.openListener({listenAddress:o.ListenAddress});t.data.status===200?(await d(),n.success("开启监听成功")):(await d(),n.error(t.data.data))},T=async o=>{const t=await p.closeListener({listenAddress:o.ListenAddress});t.data.status===200?(await d(),n.success("关闭监听成功")):(await d(),n.error(t.data.data))},h=async o=>{const t=await p.deleteListener({listenAddress:o.ListenAddress});t.data.status===200?(await d(),n.success("删除监听成功")):(await d(),n.error(t.data.data))};return j(async()=>{await d()}),(o,t)=>{const v=D,_=U,x=B,N=I,f=$,P=K,i=F,w=H,O=M,z=G;return y(),q("div",null,[e(v,{size:"large",type:"primary",onClick:t[0]||(t[0]=a=>m.value=!0)},{default:s(()=>[c("添加Listener")]),_:1}),Q,R,e(N,{data:V.value},{default:s(()=>[e(_,{prop:"Type",label:"类型"}),e(_,{prop:"ListenAddress",label:"监听地址"}),e(_,{prop:"ConnectAddress",label:"连接地址"}),e(_,{label:"状态",prop:"Status"},{default:s(({row:a})=>[e(x,{type:a.Status===1?"success":"danger",size:"default"},{default:s(()=>[c(J(a.Status===1?"开启":"关闭"),1)]),_:2},1032,["type"])]),_:1}),e(_,{label:"操作"},{default:s(a=>[a.row.Status===2?(y(),k(v,{key:0,size:"small",type:"success",onClick:C=>E(a.row)},{default:s(()=>[c("开启")]),_:2},1032,["onClick"])):L("",!0),a.row.Status===1?(y(),k(v,{key:1,size:"small",type:"primary",onClick:C=>T(a.row)},{default:s(()=>[c("关闭")]),_:2},1032,["onClick"])):L("",!0),e(v,{size:"small",type:"danger",onClick:C=>h(a.row)},{default:s(()=>[c("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(z,{modelValue:m.value,"onUpdate:modelValue":t[6]||(t[6]=a=>m.value=a),title:"添加Listener",width:"500px"},{default:s(()=>[e(O,{model:l.value,"label-width":"120px"},{default:s(()=>[e(i,{label:"协议"},{default:s(()=>[e(P,{modelValue:l.value.protocol,"onUpdate:modelValue":t[1]||(t[1]=a=>l.value.protocol=a),placeholder:"请选择协议"},{default:s(()=>[e(f,{label:"Websocket",value:"websocket"}),e(f,{label:"TCP",value:"tcp"}),e(f,{label:"KCP",value:"kcp"}),e(f,{label:"HTTP",value:"http"}),e(f,{label:"OSS",value:"oss"})]),_:1},8,["modelValue"])]),_:1}),l.value.protocol==="oss"?(y(),k(i,{key:0,label:"EndPoint"},{default:s(()=>[e(w,{modelValue:u.value.endpoint,"onUpdate:modelValue":t[2]||(t[2]=a=>u.value.endpoint=a),style:{width:"300px"}},null,8,["modelValue"])]),_:1})):L("",!0),e(i,{label:l.value.protocol==="oss"?"AccessKeyId":"监听地址"},{default:s(()=>[e(w,{modelValue:l.value.listenAddress,"onUpdate:modelValue":t[3]||(t[3]=a=>l.value.listenAddress=a),placeholder:l.value.protocol==="oss"?"":"0.0.0.0:8083",style:{width:"300px"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(i,{label:l.value.protocol==="oss"?"AccessKeySecret":"连接地址"},{default:s(()=>[e(w,{modelValue:l.value.connectAddress,"onUpdate:modelValue":t[4]||(t[4]=a=>l.value.connectAddress=a),placeholder:l.value.protocol==="oss"?"":"外网连接地址（127.0.0.1:8083)",style:{width:"300px"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l.value.protocol==="oss"?(y(),k(i,{key:1,label:"BucketName"},{default:s(()=>[e(w,{modelValue:u.value.bucketName,"onUpdate:modelValue":t[5]||(t[5]=a=>u.value.bucketName=a),style:{width:"300px"}},null,8,["modelValue"])]),_:1})):L("",!0),e(i,null,{default:s(()=>[e(v,{type:"primary",onClick:g},{default:s(()=>[c("添加")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});export{re as default};
